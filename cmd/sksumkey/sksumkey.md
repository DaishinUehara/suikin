# 水琴オンラインコマンドマニュアル

## 【名前】

sksumkey : プライマリキー単位で値を集計

## 【書式】

    sksumkey -if <infield1>,<infield2> -of <outfield1> [+count] <pk1>,<pk2> <sum1>,<sum2> <file>

## 【説明】

&lt;file&gt;ファイルから、pk1,pk2のキーが同じ行の各フィールドの値を集計する。
pk1～pk2で指定したフィールドをプライマリキーとして、sum1,...で指定した
各フィールドを集計する。同じキーをもつ行は1行に集計して出力する。
キーまたは集計フィールドいずれの範囲にも指定していないフィールドは出力はされない。
ファイル形式は1行目にフィールド名を入れておく必要がある。

### 【例1】

$ cat data
工場番号 工場名 日付 H鋼生産量 I鋼生産量
0001 水島工場 20060201 91 70
0001 水島工場 20060202 80 60
0001 水島工場 20060203 84 59
0002 北九州工場 20060201 21 32
0002 北九州工場 20060202 21 32
0002 北九州工場 20060203 21 32

工場別の生産量の合計を出力させる。第1フィールドから第2フィールドをキーとして第4フ
ィールドから第8フィールドを集計する。

$ sumkey 1 2 4 8 data
工場番号 工場名 H鋼生産量(計) I鋼生産量(計)
0001 新橋店 219 98 51 165 85
0002 池袋店 166 134 135 74 87
0003 新宿店 184 172 93 45 142
0004 上野店 247 205 151 207 157
$

### 【例2】

+countオプションはキー毎の集計すると同時に、元データの各キー毎の行の行数をキー
の直後に挿入出力する。

$ cat data
商品コード 個数
1111 3
1111 5
1111 2
2222 3
2222 10
3333 4
3333 8
3333 9
3333 6
$

キーが同一の行を出力する。

$ sumkey +count 1 1 2 2 data
商品コード レコード数 個数(計)
1111 3 10
2222 2 13
3333 4 27
$

### 【例3】

sumkeyは小数点がある場合、各キー、各フィールド毎に一番精度の高い数に合わせて出
力する。

$ cat data3
製品 重量 長さ
a 1.4 2.55
a 2   4
b 1.33 2.1
b 5.222 3.12
$

$ sm2 製品 製品 2 3 data3
a 3.4 6.55
b 6.552 5.22
$

【例4】

キーを0 0に指定すると、集計フィールドの総合計を出力する。

$ cat data4
a 1
b 2
c 3
$

$ sm2 0 0 2 2 data4
6
$

指定したディレクトリに存在するファイルのサイズを合計するには次のようにコマンド
を実行する。

$ ls -l directory | sm2 0 0 5 5

【関連項目】

kasan(1)、plus(1)、ratio(1)、sm4(1)、sm5(1)、ysum(1)

last modified: 2014-01-13 16:01:13
Contact us: uecinfo@usp-lab.com
Copyright (c) 2012-2014 Universal Shell Programming Laboratory All Rights
